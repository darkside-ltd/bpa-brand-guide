---
import { getCollection, getEntryBySlug, CollectionEntry } from 'astro:content';

// Get all collection data pages
const allData = await getCollection("data");

function lowerCase(v) {
    return v.toLowerCase()
}

export async function getStaticPaths() {
    // Define the colection you are creating pages for
    const allPosts = await getCollection("data");

    const numberOfPosts = allPosts.length

    return allPosts.map((post, i) => ({ // Map() all posts after sorting
    params: {
      slug: post.data.title.toLowerCase(),
    },
    props: {
      dataProp: post,
      prevPost: // Previous post
        i + 1 === numberOfPosts // If the current post is the oldest
          ? { frontmatter: ""}
          : allPosts[i + 1],
      nextPost: // Next post
        i === 0 // If the current post is the newest
          ? { frontmatter: "" }
          : allPosts[i - 1],
    },
  }))

    return allData.map((e) => {
		// console.log(e.slug)
        return {
            params: { slug: e.slug },
            props: { dataProp: e },
        };
    });
}

// Access the props in this component 
const {dataProp} = Astro.props as {dataProp: CollectionEntry<"data">};
const {Content} = await dataProp.render();
---

<Content />